<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="ä»¤è¡Œç¦æ­¢">
<meta property="og:type" content="website">
<meta property="og:title" content="Airy">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="Airy">
<meta property="og:description" content="ä»¤è¡Œç¦æ­¢">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Airy">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>Airy</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Airy</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/01/01/%E8%80%81%E5%8F%B8%E6%9C%BA%E5%B8%A6%E4%BD%A0%E7%94%A8%20PHP%20%E5%AE%9E%E7%8E%B0%20Websocket%20%E5%8D%8F%E8%AE%AE/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/avatar.gif">
      <meta itemprop="name" content="Airy">
      <meta itemprop="description" content="ä»¤è¡Œç¦æ­¢">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Airy">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/01/01/%E8%80%81%E5%8F%B8%E6%9C%BA%E5%B8%A6%E4%BD%A0%E7%94%A8%20PHP%20%E5%AE%9E%E7%8E%B0%20Websocket%20%E5%8D%8F%E8%AE%AE/" class="post-title-link" itemprop="url">è€å¸æœºå¸¦ä½ ç”¨ PHP å®ç° Websocket åè®®</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              

              <time title="åˆ›å»ºæ—¶é—´ï¼š2021-01-01 15:56:16 / ä¿®æ”¹æ—¶é—´ï¼š17:18:18" itemprop="dateCreated datePublished" datetime="2021-01-01T15:56:16+08:00">2021-01-01</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/socket/" itemprop="url" rel="index"><span itemprop="name">socket</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>æœ¬æ–‡è½¬è½½è‡ª LearnKu ç¤¾åŒºä½œè€… Dennis_Ritchie<br>åŸæ–‡åœ°å€ï¼š<a target="_blank" rel="noopener" href="https://learnku.com/articles/36471">https://learnku.com/articles/36471</a></p>
</blockquote>
<h2 id="æˆ‘ä¸ºä»€ä¹ˆä¼šå†™è¿™ç¯‡æ–‡ç« ï¼Ÿ"><a href="#æˆ‘ä¸ºä»€ä¹ˆä¼šå†™è¿™ç¯‡æ–‡ç« ï¼Ÿ" class="headerlink" title="æˆ‘ä¸ºä»€ä¹ˆä¼šå†™è¿™ç¯‡æ–‡ç« ï¼Ÿ"></a>æˆ‘ä¸ºä»€ä¹ˆä¼šå†™è¿™ç¯‡æ–‡ç« ï¼Ÿ</h2><p>å½“åˆä½œä¸ºç¼–ç¨‹å°ç™½çš„æˆ‘ï¼Œåˆšåˆšä»äº‹åå°å·¥ä½œï¼Œè§‰å¾—httpæ˜¯ä¸ªå¾ˆç‰›é€¼çš„ä¸œè¥¿ï¼Œç„¶è€Œåé¢éšç€è‡ªå·±æ·±å…¥å­¦ä¹ å¹¶å®è·µä¹‹åï¼Œè§‰å¾—åŸæ¥å’Œæˆ‘æ‰€æƒ³çš„å¤©å£¤ä¹‹åˆ«ï¼Œæ²¡å¤§å®¶æƒ³è±¡çš„é‚£ä¹ˆå¤æ‚ï¼Œä»…ä»…æ˜¯ä¸ªåè®®å˜›ï¼ã€‚åé¢å­¦ä¹ çš„ä¸œè¥¿å¤šäº†ï¼Œæ…¢æ…¢çš„å°±æ·¡å®šäº†ã€‚ä»Šå¤©è¿™é‡Œä¹‹æ‰€ä»¥è¦è®²websocketï¼Œè€Œä¸æ˜¯å…¶å®ƒçš„åè®®ï¼Œä»æŸç§æ„ä¹‰ä¸Šæ¥è¯´ï¼ˆè¯·å…è®¸æˆ‘è£…ä¸ªé€¼ï¼‰ï¼Œæ›´èƒ½è¯´æ˜é—®é¢˜ï¼Œå¦‚æœä½ æŠŠwebsocketéƒ½ææ‡‚äº†ï¼Œé‚£ä¹ˆhttpå¯¹äºä½ æ¥è¯´ï¼Œç®€ç›´å°±æ˜¯é›•è™«å°æŠ€å•Šï¼Œå…³äºwebsocketçš„ä»£ç ï¼Œä»¥å‰æˆ‘ä½¿ç”¨Cå’ŒC++å†™çš„ï¼Œä½†æ˜¯ä¸ºäº†PHPçš„coderï¼ˆPHPæ˜¯ä¸–ç•Œä¸Šæœ€å¥½çš„è¯­è¨€ï¼‰èƒ½æ˜ç™½ï¼Œæˆ‘ç”¨PHPé‡æ–°å†™äº†ä¸€éï¼Œä½†æ˜¯ä¸ªç²¾ç®€ç‰ˆï¼Œå¯¹äºæˆ‘ä»¬å½»åº•ææ‡‚websocketï¼Œç†è§£å®ƒçš„ç²¾åæ‰€åœ¨ï¼Œå·²ç»è¶³å¤Ÿäº†ã€‚ä»£ç æˆ‘å·²ç»ä¸Šä¼ åˆ°äº†ç äº‘ï¼ˆ<a target="_blank" rel="noopener" href="https://gitee.com/obamajs/php-websocket-base-implemention">php-websocket-base-implemention</a>ï¼‰ï¼Œ<strong>è¯·å¤§å®¶ä¸€å®šä¸€å®šè¦ä¸‹è½½ä¸‹æ¥ï¼Œå¹¶äº²è‡ªè¿è¡Œ</strong>ï¼Œ<strong>å®è·µæ‰æ˜¯æ£€éªŒçœŸç†çš„å”¯ä¸€æ ‡å‡†å•Š</strong>ï¼Œä»£ç æ˜¯å®Œå…¨å¯ä»¥è¿è¡Œçš„ï¼Œå¦‚æœè¿è¡Œçš„æ—¶å€™æœ‰éšœç¢ï¼Œè¯·è”ç³»æˆ‘ã€‚è¯¥åšæ–‡å·®ä¸å¤šä¿®ä¿®æ”¹æ”¹äº†3å¤©ï¼ˆå¹¸äºå…¬å¸é‡Œé¢äº‹ä¸å¤šï¼‰ï¼Œå°½å¯èƒ½çš„ç»™å¤§å®¶è®²æ¸…æ¥šã€‚çªç„¶æ„Ÿè§‰ï¼Œå†™æ–‡ç« å¥½ç´¯å•Šï¼Œè¿™éƒ½ä¸é‡è¦ï¼Œå¸Œæœ›å¤§å®¶èƒ½å¤Ÿçœ‹æ‡‚ï¼Œä¸ç„¶æˆ‘å†™çš„å°±æ²¡å•¥ç”¨äº†ã€‚æ›´å¸Œæœ›å¤§å®¶é‡åˆ°ä¸æ‡‚çš„ï¼Œæå‡ºç–‘é—®ã€‚å†™å®Œä¹‹åï¼Œæˆ‘å†æ¬¡å®¡æŸ¥äº†å½“å‰åšæ–‡çš„å†…å®¹ï¼Œä¿®æ”¹äº†ä¸€äº›æ‹¼å†™é”™è¯¯ï¼Œå¯èƒ½è¿˜ä¼šæœ‰ä¸€äº›æ¼ç½‘ä¹‹é±¼ï¼Œå¸Œæœ›å¤§å®¶å¤šå¤šæŒ‡æ­£ã€‚</p>
<h2 id="æ–‡ç« é“¾æ¥"><a href="#æ–‡ç« é“¾æ¥" class="headerlink" title="æ–‡ç« é“¾æ¥"></a>æ–‡ç« é“¾æ¥</h2><p><a target="_blank" rel="noopener" href="https://learnku.com/articles/36655">PHPå®ç°Base64ç¼–ç </a></p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2021/01/01/%E8%80%81%E5%8F%B8%E6%9C%BA%E5%B8%A6%E4%BD%A0%E7%94%A8%20PHP%20%E5%AE%9E%E7%8E%B0%20Websocket%20%E5%8D%8F%E8%AE%AE/#more" rel="contents">
                é˜…è¯»å…¨æ–‡ &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/07/07/PHP-%E4%B8%8E-JavaScript-%E7%AB%AF%E4%B9%8B%E9%97%B4%E7%9A%84%E5%8A%A0%E5%AF%86%E8%A7%A3%E5%AF%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/avatar.gif">
      <meta itemprop="name" content="Airy">
      <meta itemprop="description" content="ä»¤è¡Œç¦æ­¢">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Airy">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/07/07/PHP-%E4%B8%8E-JavaScript-%E7%AB%AF%E4%B9%8B%E9%97%B4%E7%9A%84%E5%8A%A0%E5%AF%86%E8%A7%A3%E5%AF%86/" class="post-title-link" itemprop="url">PHP ä¸ JavaScript ç«¯ä¹‹é—´çš„åŠ å¯†è§£å¯†</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2020-07-07 12:36:10" itemprop="dateCreated datePublished" datetime="2020-07-07T12:36:10+08:00">2020-07-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-12-31 11:04:44" itemprop="dateModified" datetime="2020-12-31T11:04:44+08:00">2020-12-31</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>è½¬è½½äº <a target="_blank" rel="noopener" href="https://learnku.com/laravel/t/46851">https://learnku.com/laravel/t/46851</a></p>
</blockquote>
<p><img src="https://cdn.learnku.com/uploads/images/202007/03/1/HdUs6edXk0.png!large" alt="Laravel"></p>
<p>åªæ˜¯ä¸ºäº†å¥½ç©ï¼Œè®©æˆ‘ä»¬åœ¨å®¢æˆ·ç«¯JavaScriptä¸­åŠ å¯†ä¸€äº›å†…å®¹ï¼Œç„¶åè®©PHPæœåŠ¡å™¨å¯¹å…¶è¿›è¡Œè§£å¯†ã€‚è¯·æ³¨æ„<strong>è¿™ä¸ªÂ <a target="_blank" rel="noopener" href="https://stackoverflow.com/a/12327375/2224584">ä¸ä¼šå–ä»£TLS (HTTPS)</a></strong>.</p>
<h3 id="ä½¿ç”¨-Nadium-Plus-çš„-JavaScript-åŠ å¯†"><a href="#ä½¿ç”¨-Nadium-Plus-çš„-JavaScript-åŠ å¯†" class="headerlink" title="ä½¿ç”¨ Nadium Plus çš„ JavaScript åŠ å¯†"></a>ä½¿ç”¨ Nadium Plus çš„ JavaScript åŠ å¯†</h3><p>ä½ éœ€è¦Â <a target="_blank" rel="noopener" href="https://github.com/paragonie/sodium-plus/releases">æœ€æ–°ç‰ˆçš„ sodium-plus</a>Â ï¼ˆåœ¨æ’°å†™æœ¬æ–‡æ—¶ï¼Œå®ƒæ˜¯Â <a target="_blank" rel="noopener" href="https://github.com/paragonie/sodium-plus/releases/tag/v0.4.0">version 0.4.0</a>.)</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;script</span><br><span class="line">  src=<span class="string">&quot;/static/js/sodium-plus.min.js&quot;</span></span><br><span class="line">  integrity=<span class="string">&quot;sha384-lv7SVE0eb0bXA3fgK6PwlhViiUwG6tBuMAhS8XX7RvBvyRcdEdJ8HKtFgs4vHTUh&quot;</span></span><br><span class="line">&gt;&lt;/script&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>æ¥ä¸‹æ¥ï¼Œæ‚¨å°†è¦ç¼–å†™ä¸€äº›JavaScriptä»£ç æ¥åŠ å¯†æ¶ˆæ¯å¹¶å°†å…¶å‘é€åˆ°æœåŠ¡å™¨ã€‚æˆ‘å°†åœ¨æ­¤ç¤ºä¾‹ä¸­ä½¿ç”¨jQueryï¼Œä½†æ˜¯æ‚¨å¯ä»¥è½»æ¾åœ°ä½¿å…¶é€‚åº”ä½¿ç”¨<code>XMLHttpRequest</code>å¯¹è±¡ã€‚</p>
<p>è®©æˆ‘ä»¬å®šä¹‰ä¸¤ä¸ªå‡½æ•°ã€‚äººä»¬ä»ç¡¬ç¼–ç çš„å­—ç¬¦ä¸²ä¸­åŠ è½½äº†ä¸€ä¸ª<code>CryptographyKey</code>å¯¹è±¡(n.b.æ‚¨ä»ä¸æƒ³çœŸæ­£è¿™æ ·åšï¼Œä½†æ˜¯ä¸ºäº†ç®€å•æ˜“ç”¨çš„ç¤ºä¾‹ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ç¡¬ç¼–ç çš„ç§˜å¯†)ã€‚å¦ä¸€ä¸ªå®é™…ä¸ŠåŠ å¯†äº†ä¸€æ¡æ¶ˆæ¯ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è·å–ç¤ºä¾‹å¯†é’¥ã€‚åœ¨ç°å®ä¸–ç•Œä¸­ï¼Œä½ éœ€è¦éšæœºç”Ÿæˆè¿™äº›ã€‚</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">getExampleKey</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">window</span>.sodium) <span class="built_in">window</span>.sodium = <span class="keyword">await</span> SodiumPlus.auto();</span><br><span class="line">    <span class="keyword">return</span> CryptographyKey.from(</span><br><span class="line">        <span class="string">&#x27;e9897cea109576c2f8088c277125d553e4f83afbc0abbb92cfb1f7b776b4fee0&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;hex&#x27;</span></span><br><span class="line">    );</span><br><span class="line">    <span class="comment">// return await sodium.crypto_secretbox_keygen();</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * åŠ å¯†ä¼ å…¥çš„ message.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">encryptMessage</span>(<span class="params">message, key</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="built_in">window</span>.sodium) <span class="built_in">window</span>.sodium = <span class="keyword">await</span> SodiumPlus.auto();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> nonce = <span class="keyword">await</span> sodium.randombytes_buf(<span class="number">24</span>);</span><br><span class="line">    <span class="keyword">let</span> encrypted = <span class="keyword">await</span> sodium.crypto_secretbox(message, nonce, key);</span><br><span class="line">    <span class="keyword">return</span> nonce.toString(<span class="string">&#x27;hex&#x27;</span>) + encrypted.toString(<span class="string">&#x27;hex&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<p>æ¥ä¸‹æ¥ï¼Œæ‚¨å°†è¦ç¼–å†™ä¸€ä¸ªå‡½æ•°æ¥æ”¶é›†ç”¨æˆ·è¾“å…¥ï¼Œå¯¹å…¶è¿›è¡ŒåŠ å¯†ï¼Œç„¶åå°†å…¶å‘é€åˆ°æœåŠ¡å™¨ã€‚</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">sendEncryptedMessage</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> key = <span class="keyword">await</span> getExampleKey();</span><br><span class="line">    <span class="keyword">let</span> message = $(<span class="string">&quot;#user-input&quot;</span>).val();</span><br><span class="line">    <span class="keyword">let</span> encrypted = <span class="keyword">await</span> encryptMessage(message, key);</span><br><span class="line">    $.post(<span class="string">&quot;/send-message&quot;</span>, &#123;<span class="string">&quot;message&quot;</span>: encrypted&#125;, <span class="function"><span class="keyword">function</span> (<span class="params">response</span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(response);</span><br><span class="line">        $(<span class="string">&quot;#output&quot;</span>).append(<span class="string">&quot;&lt;li&gt;&lt;pre&gt;&quot;</span> + response.message + <span class="string">&quot;&lt;/pre&gt;&lt;/li&gt;&quot;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>â€¦ä»¥åŠä¸€äº›æ”¯æŒHTMLçš„å†…å®¹ï¼š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;user-input&quot;</span>&gt;</span>Type a message to encrypt and send:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">textarea</span> <span class="attr">id</span>=<span class="string">&quot;user-input&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;send-it&quot;</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span>&gt;</span>Send Encrypted Message<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">hr</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ol</span> <span class="attr">id</span>=<span class="string">&quot;output&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span></span><br><span class="line"><span class="javascript">$(<span class="string">&quot;#send-it&quot;</span>).on(<span class="string">&#x27;click&#x27;</span>, sendEncryptedMessage);</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="ä½¿ç”¨-Sodium-è§£å¯†-PHP"><a href="#ä½¿ç”¨-Sodium-è§£å¯†-PHP" class="headerlink" title="ä½¿ç”¨ Sodium è§£å¯† PHP"></a>ä½¿ç”¨ Sodium è§£å¯† PHP</h3><p>ä½ éœ€è¦Â <a target="_blank" rel="noopener" href="https://github.com/paragonie/sodium_compat">paragonie/sodium_compat</a>.</p>
<p>å¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯ PHP 7.2 ï¼Œåˆ™å¾ˆæœ‰å¯èƒ½åªä½¿ç”¨å†…ç½®çš„Â <code>sodium_*</code>Â å‡½æ•°ã€‚ä½†æ˜¯ï¼Œé»˜è®¤æƒ…å†µä¸‹æŸäº›å‘è¡Œç‰ˆ <em>å¯èƒ½</em> é”™è¯¯åœ°ç¦ç”¨äº†é’ æ‰©å±•åã€‚å› æ­¤ï¼Œä¸ºäº†å®‰å…¨èµ·è§ï¼Œæ— è®ºå¦‚ä½•éƒ½è¦å®‰è£…sodium_compatã€‚</p>
<p>å¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯æ¡†æ¶(Symfonyï¼ŒLaravel)ï¼Œæ‚¨çš„ä»£ç çœ‹èµ·æ¥ä¼šå¹²å‡€å¾ˆå¤šï¼Œä½†æ˜¯ä¸ºäº†è¯´æ˜èµ·è§ï¼Œè§£å¯†ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">declare</span>(strict_types=<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">require</span> <span class="string">&#x27;vendor/autoload.php&#x27;</span>; <span class="comment">// Composer</span></span><br><span class="line"></span><br><span class="line">header(<span class="string">&#x27;Content-Type: application/json&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$key</span> = sodium_hex2bin(<span class="string">&#x27;e9897cea109576c2f8088c277125d553e4f83afbc0abbb92cfb1f7b776b4fee0&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$encrypted</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;message&#x27;</span>] ?? <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">if</span> (!<span class="variable">$encrypted</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> json_encode(</span><br><span class="line">        [<span class="string">&#x27;message&#x27;</span> =&gt; <span class="literal">null</span>, <span class="string">&#x27;error&#x27;</span> =&gt; <span class="string">&#x27;no message provided&#x27;</span>],</span><br><span class="line">        JSON_PRETTY_PRINT</span><br><span class="line">    );</span><br><span class="line">    <span class="keyword">exit</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$nonce</span> = sodium_hex2bin(substr(<span class="variable">$encrypted</span>, <span class="number">0</span>, <span class="number">48</span>));</span><br><span class="line"><span class="variable">$ciphertext</span> = sodium_hex2bin(substr(<span class="variable">$encrypted</span>, <span class="number">48</span>));</span><br><span class="line"><span class="variable">$plaintext</span> = sodium_crypto_secretbox_open(<span class="variable">$ciphertext</span>, <span class="variable">$nonce</span>, <span class="variable">$key</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> json_encode(</span><br><span class="line">    [<span class="string">&#x27;message&#x27;</span> =&gt; <span class="variable">$plaintext</span>, <span class="string">&#x27;original&#x27;</span> =&gt; <span class="variable">$encrypted</span>],</span><br><span class="line">    JSON_PRETTY_PRINT</span><br><span class="line">);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="æŠŠå®ƒæ”¾åœ¨ä¸€èµ·"><a href="#æŠŠå®ƒæ”¾åœ¨ä¸€èµ·" class="headerlink" title="æŠŠå®ƒæ”¾åœ¨ä¸€èµ·"></a>æŠŠå®ƒæ”¾åœ¨ä¸€èµ·</h3><p>å½“æ‚¨é”®å…¥ä¸€æ¡æ¶ˆæ¯å¹¶æŒ‰ä¸‹æŒ‰é’®æ—¶ï¼Œå®ƒå°†å¯¹å…¶è¿›è¡ŒåŠ å¯†å¹¶å°†åå…­è¿›åˆ¶ç¼–ç çš„å­—ç¬¦ä¸²å‘é€åˆ°æœåŠ¡å™¨ã€‚</p>
<p>ç„¶åï¼ŒPHPä»£ç å°†è§£å¯†æ¶ˆæ¯å¹¶ä»¥JSONå“åº”è¿”å›çº¯æ–‡æœ¬ã€‚</p>
<p>ç„¶åï¼ŒJavaScriptä»£ç å°†ä»JSONå“åº”ä¸­è·å–çº¯æ–‡æœ¬ï¼Œå¹¶å°†å…¶é™„åŠ åˆ°è¡¨å•ä¸‹æ–¹çš„è¾“å‡ºå­—æ®µã€‚</p>
<h2 id="å®‰å…¨è€ƒè™‘å› ç´ "><a href="#å®‰å…¨è€ƒè™‘å› ç´ " class="headerlink" title="å®‰å…¨è€ƒè™‘å› ç´ "></a>å®‰å…¨è€ƒè™‘å› ç´ </h2><p>è¿™åªæ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼Œç”¨æ¥è¯´æ˜å¦‚ä½•ä½¿ç”¨Â <a target="_blank" rel="noopener" href="https://github.com/paragonie/sodium-plus">sodium-plus</a>ï¼ˆJavaScriptï¼‰å’Œ libsodiumï¼ˆPHPï¼‰æ¥åŠ å¯†/è§£å¯†æ¶ˆæ¯.</p>
<p>æˆ‘ä»¬ä½¿ç”¨äº†å¾ˆå¤š<em>çš„</em>å¿«æ·æ–¹å¼ï¼Œè¿™äº›å¿«æ·æ–¹å¼æ˜¯æ‚¨åœ¨å®é™…ç³»ç»Ÿä¸­ä¸å¸Œæœ›ä½¿ç”¨çš„ï¼ˆä¾‹å¦‚ï¼šå¯¹åŠ å¯†å¯†é’¥è¿›è¡Œç¡¬ç¼–ç ï¼Œå¹¶ä¸ºäº†ç®€æ´è€Œé¿å…è¿›è¡Œé”™è¯¯æ£€æŸ¥ï¼‰ã€‚</p>
<p>å¦‚æœæ‚¨æƒ³åšæ›´é«˜çº§çš„äº‹æƒ… (<a target="_blank" rel="noopener" href="https://github.com/paragonie/sodium-plus/blob/master/docs/SodiumPlus/sealed-boxes.md">JavaScriptä¸­çš„å…¬é’¥åŠ å¯†</a>Â å’ŒÂ <a target="_blank" rel="noopener" href="https://paragonie.com/book/pecl-libsodium/read/08-advanced.md#crypto-box-seal">ä¸€è‡´çš„PHPå‡½æ•°</a>), è¯¥æ–‡æ¡£å¯åœ¨çº¿å…è´¹è·å¾—ã€‚</p>
<h2 id="è¿›ä¸€æ­¥é˜…è¯»"><a href="#è¿›ä¸€æ­¥é˜…è¯»" class="headerlink" title="è¿›ä¸€æ­¥é˜…è¯»"></a>è¿›ä¸€æ­¥é˜…è¯»</h2><ul>
<li>  <a target="_blank" rel="noopener" href="https://www.nccgroup.trust/us/about-us/newsroom-and-events/blog/2011/august/javascript-cryptography-considered-harmful">æµè§ˆå™¨JavaScriptåŠ å¯†çš„å±é™©</a></li>
<li>  <a target="_blank" rel="noopener" href="https://paragonie.com/blog/2019/10/improving-cryptography-javascript-ecosystem">æ”¹å–„JavaScriptç”Ÿæ€ç³»ç»Ÿçš„å¯†ç å­¦</a></li>
<li>  <a target="_blank" rel="noopener" href="https://dev.to/paragonie/sodium-plus-a-positive-cryptography-experience-for-javascript-developers-2p08">Sodium-Plusï¼šJavaScriptå¼€å‘äººå‘˜çš„ç§¯æå¯†ç å­¦ç»éªŒ</a></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/07/06/%E6%B8%B8%E6%88%8F-%E8%8B%B1%E9%9B%84%E5%A1%94-Heroes-Tower-%E5%BC%80%E5%8F%91%E5%89%8D%E6%9E%84%E6%80%9D/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/avatar.gif">
      <meta itemprop="name" content="Airy">
      <meta itemprop="description" content="ä»¤è¡Œç¦æ­¢">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Airy">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/07/06/%E6%B8%B8%E6%88%8F-%E8%8B%B1%E9%9B%84%E5%A1%94-Heroes-Tower-%E5%BC%80%E5%8F%91%E5%89%8D%E6%9E%84%E6%80%9D/" class="post-title-link" itemprop="url">æ¸¸æˆ [è‹±é›„å¡” Heroes Tower] å¼€å‘å‰æ„æ€</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>
              

              <time title="åˆ›å»ºæ—¶é—´ï¼š2020-07-06 22:29:03 / ä¿®æ”¹æ—¶é—´ï¼š22:50:28" itemprop="dateCreated datePublished" datetime="2020-07-06T22:29:03+08:00">2020-07-06</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>æœ€è¿‘é—²æ¥æ— äº‹ï¼Œå‡†å¤‡ä½œä¸ªç®€å•çš„æ¸¸æˆæ¥å­¦ä¹ ä¸€äº›æ–°çš„æŠ€æœ¯ï¼Œä¹Ÿç»™è‡ªå·±å®šä¸‹å‡ ä¸ªè¿‘æœŸç›®æ ‡ï¼Œæ¥ç£ä¿ƒè‡ªå·±ã€‚</p>
<p>æ¸¸æˆçš„ç±»å‹è¿˜æ²¡æœ‰å®Œå…¨çš„ç¡®å®šï¼Œç›®å‰çš„æƒ³æ³•åªæ˜¯åšä¸€ä¸ªï¼Œé€‰æ‹©è‹±é›„æ¥é—¯å…³ã€å†²å¡”ã€æ‰“æ€ªçš„æ¸¸æˆæ¨¡å¼ã€‚ä»¥åå¯èƒ½ä¼šå¢åŠ æ¸¸æˆçš„å¯ç©æ€§ï¼Œå‡ºæ›´å¤šçš„è‹±é›„å’Œæ¸¸æˆæ¨¡å¼ã€‚</p>
<p>å› ä¸ºå‰ç«¯æŠ€æœ¯çš„ä¸è¶³ï¼Œæ‰€ä»¥å‡†å¤‡åšæˆä¸€ä¸ªæ–‡æœ¬æ¸¸æˆã€‚</p>
<p>å¤§æ¦‚å†…å®¹å¦‚ä¸‹ï¼Œç©å®¶å¯ä»¥é€‰æ‹©ä¸€ä¸ªè‹±é›„ï¼ˆä»¥åå¯èƒ½ä¼šè€ƒè™‘å¢åŠ å¤šè‹±é›„é…åˆçš„æ¨¡å¼ï¼‰æ¥ä½œä¸ºæ¸¸æˆçš„ä¸»è§’ï¼Œæ§åˆ¶è‹±é›„è¿›è¡Œæ¸¸æˆã€‚</p>
<p>æ¯ç§ä¸åŒçš„è‹±é›„æ‹¥æœ‰å„è‡ªçš„ä¸åŒå±æ€§å’ŒæŠ€èƒ½ï¼ˆæš‚å®šä¸ºä¸‰ä¸ªï¼‰å±æ€§å¤§æ¦‚å°±æ˜¯ï¼šç”Ÿå‘½å€¼ã€æ³•åŠ›å€¼ã€æ”»å‡»åŠ›ã€é­”æ³•å¼ºåº¦ã€ç‰©ç†æŠ—æ€§ã€é­”æ³•æŠ—æ€§ç­‰ã€‚</p>
<p>ç­‰çº§æš‚å®šä¸º30çº§ï¼Œå¯ä»¥é€šè¿‡æ‰“æ€ªè¿›è¡Œå‡çº§ã€‚æ¯ä¸ªè‹±é›„éƒ½æœ‰ä¸åŒçš„éšç­‰çº§æå‡æˆé•¿çš„å±æ€§å€¼ï¼Œé€šè¿‡å‡çº§æˆ–ç©¿æˆ´è£…å¤‡å¯ä»¥å¢åŠ è¿™äº›æ•°å€¼ã€‚é“å…·åˆ™æ˜¯å¤šåŠŸèƒ½çš„ï¼Œå¯ä»¥æ˜¯ï¼šçŸ­æš‚å¢åŠ è‹±é›„å±æ€§ï¼Œå›å¤è‹±é›„æ•°å€¼ï¼Œæå‡ç­‰çº§ï¼Œå¤æ´»ç­‰ã€‚</p>
<p>æ¯å±‚å¡”éƒ½ä¼šæœ‰ä¸åŒçš„æ€ªç‰©å’ŒBOOSæˆ–è€…æ²¡æœ‰BOOSï¼Œæ¯å±‚å’Œæ¯ç§æ€ªéƒ½ä¼šæä¾›ä¸åŒçš„ç­‰çº§ç”šè‡³ä¼šæ‰è½ä¸“å±è£…å¤‡å’Œé“å…·ã€‚</p>
<p>å½“ç„¶ï¼Œä¸ºäº†æ¸¸æˆçš„å¯ç©æ€§ï¼Œçˆ†ç‡ä¼šæ§åˆ¶åœ¨ä¸€ä¸ªè¾ƒä½èŒƒå›´å†…ï¼Œæ‰è½çš„ç‰©å“ä¹Ÿæ˜¯æ¦‚ç‡æ€§çš„ã€‚å°½é‡é¿å…å‡ºç°é—¯å…³éš¾åº¦è¿‡ä½æˆ–è¿‡é«˜çš„æƒ…å†µã€‚</p>
<p>æš‚æ—¶å…ˆå°±è¿™ä¹ˆå¤šï¼Œå†è€ƒè™‘ä¸€ä¸‹å…¶ä»–å› ç´ ï¼Œçœ‹çœ‹éœ€è¦å¢åŠ æˆ–è€…ä¿®æ”¹ç”šè‡³åˆ é™¤å“ªä¸ªéƒ¨åˆ†ã€‚</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/07/06/Laravel%20%E5%AF%B9%E5%85%B3%E8%81%94%E8%A1%A8%E7%9A%84%E4%B8%80%E4%BA%9B%E6%93%8D%E4%BD%9C/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/avatar.gif">
      <meta itemprop="name" content="Airy">
      <meta itemprop="description" content="ä»¤è¡Œç¦æ­¢">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Airy">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/07/06/Laravel%20%E5%AF%B9%E5%85%B3%E8%81%94%E8%A1%A8%E7%9A%84%E4%B8%80%E4%BA%9B%E6%93%8D%E4%BD%9C/" class="post-title-link" itemprop="url">Laravel å¯¹å…³è”è¡¨çš„ä¸€äº›æ“ä½œ</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2020-07-06 22:21:48" itemprop="dateCreated datePublished" datetime="2020-07-06T22:21:48+08:00">2020-07-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2021-01-01 16:35:06" itemprop="dateModified" datetime="2021-01-01T16:35:06+08:00">2021-01-01</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Laravel/" itemprop="url" rel="index"><span itemprop="name">Laravel</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>Laravel ä¸ºå¼€å‘è€…æä¾›äº†çµæ´»ä¸”ä¼˜é›…çš„ model å±‚ã€‚ä¸è¿‡ï¼Œå› ä¸ºæ–¹æ³•å¤ªå¤šï¼Œæœ‰æ—¶æ€»æ˜¯å¿˜è®°ä¸€äº›æœ‰ç”¨çš„æ–¹æ³•ã€‚è¿™é‡Œå°±ä¸€å¯¹å¤šæ¨¡å‹å…³è”çš„ä¸­å¯¹å…³è”è¡¨çš„ä¸€ä¸ªæ–¹æ³• with çš„ç”¨æ³•åšä¸€ä¸ªè®°å½•</p>
<p>åœ¨ä¸šåŠ¡é€»è¾‘ä¸­ï¼Œç»å¸¸ä¼šæœ‰è¿™æ ·çš„åœºæ™¯ï¼Œä¸€ä¸ªç”¨æˆ·ä¸Šä¼ æœ‰å¤šä¸ªå›¾ç‰‡ï¼Œè€Œå›¾ç‰‡åªå½’å±äºä¸€ä¸ªç”¨æˆ·ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦ä¸€å¯¹å¤šå…³è”ï¼Œå‡è®¾ç”¨æˆ·è¡¨ users å’Œ å›¾ç‰‡è¡¨ imagesã€‚images è¡¨ä¸­æœ‰ä¸€ä¸ªuser_id å­—æ®µç”¨æ¥æ ‡è®°å›¾ç‰‡æ‰€å±çš„ç”¨æˆ·ã€‚</p>
<p>åœ¨ users æ¨¡å‹ä¸­åˆ›å»ºå…³è”ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * å…³è”å›¾ç‰‡è¡¨</span></span><br><span class="line"><span class="comment"> * */</span></span><br><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">images</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;ï»¿</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;hasMany(Images::class, <span class="string">&#x27;user_id&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ­¤æ—¶è®¿é—®é›†åˆä¸­çš„ images å±æ€§å°±å¯ä»¥è®¿é—®åˆ°æ‰€æœ‰å±äºæ­¤ç”¨æˆ·çš„å›¾ç‰‡äº†ã€‚</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$user</span>   = User::where(<span class="string">&#x27;id&#x27;</span>, <span class="variable">$userId</span>))-&gt;first();</span><br><span class="line"><span class="comment">// è¿™é‡Œæœ€å¥½åŠ ä¸Šåˆ¤æ–­ï¼Œå¦‚æœæ˜¯ null å°±ä¸å­˜åœ¨ images å±æ€§</span></span><br><span class="line"><span class="variable">$images</span> = <span class="variable">$user</span>-&gt;images;<span class="comment">// è¿™å°±æ˜¯è¿™ä¸ªç”¨æˆ·çš„æ‰€æœ‰å›¾ç‰‡</span></span><br></pre></td></tr></table></figure>
<p>ç„¶è€Œï¼Œæœ‰æ—¶å€™æˆ‘ä»¬ä¸éœ€è¦å–å‡º images è¡¨çš„æ‰€æœ‰å­—æ®µï¼Œæˆ‘ä»¬åªéœ€è¦ path ä¸€ä¸ªå­—æ®µå³å¯ã€‚</p>
<p>ä½†å¦‚æœç›´æ¥ä½¿ç”¨ select([â€˜pathâ€™]) æ–¹æ³•çš„è¯ï¼Œæ˜¯æŸ¥æ‰¾çš„ users è¡¨ä¸­çš„ path å­—æ®µï¼Œç„¶è€Œ users è¡¨ä¸­å¹¶ä¸å­˜åœ¨ path å­—æ®µï¼Œè¿™æ ·ä½¿ç”¨ä¼šäº§ç”Ÿé”™è¯¯ï¼Œè¿™æ ·å°±éœ€è¦ç”¨åˆ°ä¸‹é¢çš„æ–¹æ³•ã€‚</p>
<blockquote>
<p>å…³äºé¢„åŠ è½½ç”¨æ³•å¯ä»¥å‚è€ƒ <a target="_blank" rel="noopener" href="https://learnku.com/docs/laravel/6.x/eloquent-relationships/5177#012e7e">æ–‡æ¡£</a></p>
</blockquote>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$images</span> = User::getAnchorByUuid(<span class="variable">$request</span>-&gt;get(<span class="string">&#x27;uuid&#x27;</span>))</span><br><span class="line">            -&gt;with([</span><br><span class="line">                <span class="string">&#x27;images&#x27;</span> =&gt; <span class="function"><span class="keyword">function</span> (<span class="params"><span class="variable">$query</span></span>) </span>&#123;</span><br><span class="line">                    <span class="variable">$query</span>-&gt;select([<span class="string">&#x27;path&#x27;</span>, <span class="string">&#x27;user_id&#x27;</span>]);</span><br><span class="line">                &#125;</span><br><span class="line">            ])</span><br><span class="line">            -&gt;first()</span><br><span class="line">            -&gt;images;</span><br></pre></td></tr></table></figure>
<p>æˆ–è€…</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$images</span> = User::where(<span class="string">&#x27;id&#x27;</span>, <span class="variable">$request</span>-&gt;get(<span class="string">&#x27;uuid&#x27;</span>))</span><br><span class="line">            -&gt;with(<span class="string">&#x27;images:path,user_id&#x27;</span>)</span><br><span class="line">            -&gt;first()</span><br><span class="line">            -&gt;images;</span><br></pre></td></tr></table></figure>
<p>with å¯ä»¥ä½¿ç”¨å­—ç¬¦ä¸²æˆ–è€…æ•°ç»„ï¼Œæ•°ç»„çš„å€¼å¯ä»¥æ˜¯é—­åŒ…å‡½æ•°ï¼Œç¬¬ä¸€ç§æ–¹å¼æ›´åŠ çµæ´»ï¼Œç¬¬äºŒç§åˆ™æ›´åŠ ç®€ä¾¿ï¼Œé—­åŒ…ä¸­å¯ä»¥ä½¿ç”¨æ›´å¤šçš„æ–¹æ³•ï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$images</span> = User::getAnchorByUuid(<span class="variable">$request</span>-&gt;get(<span class="string">&#x27;uuid&#x27;</span>))</span><br><span class="line">            -&gt;with([</span><br><span class="line">                <span class="string">&#x27;images&#x27;</span> =&gt; <span class="function"><span class="keyword">function</span> (<span class="params"><span class="variable">$query</span></span>) </span>&#123;</span><br><span class="line">                    <span class="variable">$query</span>-&gt;orderByDesc(<span class="string">&#x27;id&#x27;</span>);</span><br><span class="line">                    <span class="variable">$query</span>-&gt;where(<span class="string">&#x27;status&#x27;</span>, <span class="number">0</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            ]);</span><br></pre></td></tr></table></figure>
<p>æœ¬ç¯‡æ–‡ç« å°±åˆ°æ­¤ç»“æŸäº†ï¼Œä¸»è¦ç›®çš„æ˜¯ä¸ºäº†è®°å½•ä¸€ä¸‹ with çš„ç”¨æ³•ã€‚</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2020/01/11/%E8%B0%83%E4%BC%91%E7%9A%84%E4%B8%80%E5%A4%A9/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/avatar.gif">
      <meta itemprop="name" content="Airy">
      <meta itemprop="description" content="ä»¤è¡Œç¦æ­¢">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Airy">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/01/11/%E8%B0%83%E4%BC%91%E7%9A%84%E4%B8%80%E5%A4%A9/" class="post-title-link" itemprop="url">è°ƒä¼‘çš„ä¸€å¤©</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2020-01-11 15:30:21" itemprop="dateCreated datePublished" datetime="2020-01-11T15:30:21+08:00">2020-01-11</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2020-07-06 22:49:33" itemprop="dateModified" datetime="2020-07-06T22:49:33+08:00">2020-07-06</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>å‘¨å…­ï¼Œæœ¬æ¥è¦ä¼‘æ¯çš„æ—¥å­ï¼Œæˆ‘å´è¿˜åœ¨ä¸Šç­ğŸ˜‚</p>
<p>ä¸è¿‡ä¸æ˜¯åŠ ç­ï¼Œè°è®©æˆ‘ä¸Šæ¬¡è°ƒä¼‘ä¼‘æ¯è¿‡äº†ã€‚è®©æˆ‘æƒ³èµ·ä¸€å¥ç»å…¸å°è¯â€œå‡ºæ¥æ··ï¼Œè¿Ÿæ—©è¦è¿˜çš„â€è¿™ä¸ã€‚æ¥è¡¥ç­äº†å˜›ã€‚</p>
<p>ä¸è¿‡ä¹ŸæŒºå¥½ï¼Œäººå°‘æ¸…å‡€ï¼Œå°±è¿å¹³æ—¶é¢†å¯¼åœ¨æ—¶è·Ÿåªé¸¡å´½ä¸€æ ·çš„åŒäº‹ï¼Œéƒ½å¤§èƒ†çš„ç©èµ·äº†æ¸¸æˆã€‚çœŸèœï¼</p>
<p><img src="http://blog.chongyunct.com/storage/canvas/images/t2804JlgNcRG7D8rwAeaHHNMMxTjhYqNU5ynCGlY.png" alt="avatar"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Airy"
      src="/uploads/avatar.gif">
  <p class="site-author-name" itemprop="name">Airy</p>
  <div class="site-description" itemprop="description">ä»¤è¡Œç¦æ­¢</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">5</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Airy</span>
</div>
  <div class="powered-by">ç”± <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> å¼ºåŠ›é©±åŠ¨
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/pjax/pjax.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>

  <script>
var pjax = new Pjax({
  selectors: [
    'head title',
    '#page-configurations',
    '.content-wrap',
    '.post-toc-wrap',
    '.languages',
    '#pjax'
  ],
  switches: {
    '.post-toc-wrap': Pjax.switches.innerHTML
  },
  analytics: false,
  cacheBust: false,
  scrollTo : !CONFIG.bookmark.enable
});

window.addEventListener('pjax:success', () => {
  document.querySelectorAll('script[data-pjax], script#page-configurations, #pjax script').forEach(element => {
    var code = element.text || element.textContent || element.innerHTML || '';
    var parent = element.parentNode;
    parent.removeChild(element);
    var script = document.createElement('script');
    if (element.id) {
      script.id = element.id;
    }
    if (element.className) {
      script.className = element.className;
    }
    if (element.type) {
      script.type = element.type;
    }
    if (element.src) {
      script.src = element.src;
      // Force synchronous loading of peripheral JS.
      script.async = false;
    }
    if (element.dataset.pjax !== undefined) {
      script.dataset.pjax = '';
    }
    if (code !== '') {
      script.appendChild(document.createTextNode(code));
    }
    parent.appendChild(script);
  });
  NexT.boot.refresh();
  // Define Motion Sequence & Bootstrap Motion.
  if (CONFIG.motion.enable) {
    NexT.motion.integrator
      .init()
      .add(NexT.motion.middleWares.subMenu)
      .add(NexT.motion.middleWares.postList)
      .bootstrap();
  }
  NexT.utils.updateSidebarPosition();
});
</script>




  















    <div id="pjax">
  

  

    </div>
</body>
</html>
